'use strict';

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol ? "symbol" : typeof obj; };

var querystring = require('querystring');

var initialized = false;
var msgpath = { host: 'rest.nexmo.com', path: '/sms/json' };
var shortcodePath = { host: 'rest.nexmo.com', path: '/sc/us/${type}/json' };
var ttsEndpoint = { host: 'api.nexmo.com', path: '/tts/json' };
var ttsPromptEndpoint = { host: 'api.nexmo.com', path: '/tts-prompt/json' };
var callEndpoint = { host: 'rest.nexmo.com', path: '/call/json' };
var verifyEndpoint = { host: 'api.nexmo.com', path: '/verify/json' };
var checkVerifyEndpoint = { host: 'api.nexmo.com', path: '/verify/check/json' };
var controlVerifyEndpoint = { host: 'api.nexmo.com', path: '/verify/control/json' };
var searchVerifyEndpoint = { host: 'api.nexmo.com', path: '/verify/search/json' };
var niEndpoint = { host: 'api.nexmo.com', path: '/ni/advanced/async/json' };
var niBasicEndpoint = { host: 'api.nexmo.com', path: '/ni/basic/json' };
var niStandardEndpoint = { host: 'api.nexmo.com', path: '/ni/standard/json' };
var niAdvancedEndpoint = { host: 'api.nexmo.com', path: '/ni/advanced/json' };
var applicationsEndpoint = { host: 'api.nexmo.com', path: '/v1/applications' };
var up = {};
var numberPattern = new RegExp("^[0-9 +()-]*$");
var _options = null;

//Error message resources are maintained globally in one place for easy management
var ERROR_MESSAGES = {
    sender: 'Invalid from address',
    to: 'Invalid to address',
    msg: 'Invalid Text Message',
    msgParams: 'Invalid shortcode message parameters',
    countrycode: 'Invalid Country Code',
    msisdn: 'Invalid MSISDN passed',
    body: 'Invalid Body value in Binary Message',
    udh: 'Invalid udh value in Binary Message',
    title: 'Invalid title in WAP Push message',
    url: 'Invalid url in WAP Push message',
    maxDigits: 'Invalid max digits for TTS prompt',
    byeText: 'Invalid bye text for TTS prompt',
    pinCode: 'Invalid pin code for TTS confirm',
    failedText: 'Invalid failed text for TTS confirm',
    answerUrl: 'Invalid answer URL for call',
    verifyValidation: 'Missing Mandatory fields (number and/or brand)',
    checkVerifyValidation: 'Missing Mandatory fields (request_id and/or code)',
    controlVerifyValidation: 'Missing Mandatory fields (request_id and/or cmd-command)',
    searchVerifyValidation: 'Missing Mandatory fields (request_id or request_ids)',
    numberInsightAdvancedValidation: 'Missing Mandatory fields (number and/or callback url)',
    numberInsightValidation: 'Missing Mandatory field - number',
    numberInsightPatternFailure: 'Number can contain digits and may include any or all of the following: white space, -,+, (, ).',
    optionsNotAnObject: 'Options parameter should be a dictionary. Check the docs for valid properties for options',
    applicationName: 'Invalid argument: name',
    applicationType: 'Invalid argument: type (valid options: [voice])',
    applicationAnswerUrl: 'Invalid argument: answerUrl',
    applicationEventUrl: 'Invalid argument: eventUrl',
    applicationId: 'Invalid argument: appId',
    product: 'Invalid product. Should be one of [voice, sms]'
};

exports.initialize = function (pkey, psecret, options) {
    if (!pkey || !psecret) {
        throw 'key and secret cannot be empty, set valid values';
    }
    up = {
        api_key: pkey,
        api_secret: psecret
    };
    _options = options;
    initialized = true;
};

exports.sendBinaryMessage = function (sender, recipient, body, udh, callback) {
    if (!body) {
        sendError(callback, new Error(ERROR_MESSAGES.body));
    } else if (!udh) {
        sendError(callback, new Error(ERROR_MESSAGES.udh));
    } else {
        sendMessage({
            from: sender,
            to: recipient,
            type: 'binary',
            body: body,
            udh: udh
        }, callback);
    }
};

exports.sendWapPushMessage = function (sender, recipient, title, url, validity, callback) {
    if (!title) {
        sendError(callback, new Error(ERROR_MESSAGES.title));
    } else if (!url) {
        sendError(callback, new Error(ERROR_MESSAGES.url));
    } else {
        if (typeof validity == 'function') {
            callback = validity;
            validity = 86400000;
        }
        sendMessage({
            from: sender,
            to: recipient,
            type: 'wappush',
            title: title,
            validity: validity,
            url: url
        }, callback);
    }
};

exports.sendTextMessage = function (sender, recipient, message, opts, callback) {
    if (!message) {
        sendError(callback, new Error(ERROR_MESSAGES.msg));
    } else {
        if (!callback) {
            callback = opts;
            opts = {};
        }
        opts['from'] = sender;
        opts['to'] = recipient;
        opts['text'] = message;
        sendMessage(opts, callback);
    }
};

exports.sendMessage = function (opts, callback) {
    sendMessage(opts, callback);
};
function sendMessage(data, callback) {
    if (!data.from) {
        sendError(callback, new Error(ERROR_MESSAGES.sender));
    } else if (!data.to) {
        sendError(callback, new Error(ERROR_MESSAGES.to));
    } else {
        var path = clone(msgpath);
        path.path += '?' + querystring.stringify(data);
        _options.logger.info('sending message from ' + data.from + ' to ' + data.to + ' with message ' + data.text);
        sendRequest(path, 'POST', function (err, apiResponse) {
            if (!err && apiResponse.status && apiResponse.messages[0].status > 0) {
                sendError(callback, new Error(apiResponse.messages[0]['error-text']), apiResponse);
            } else {
                if (callback) callback(err, apiResponse);
            }
        });
    }
}

function sendViaShortcode(type, recipient, messageParams, opts, callback) {
    if (!recipient) {
        sendError(callback, new Error(ERROR_MESSAGES.to));
    }
    if (!messageParams || !Object.keys(messageParams)) {
        sendError(callback, new Error(ERROR_MESSAGES.msgParams));
    }
    opts = opts || {};
    var path = clone(shortcodePath);
    path.path = path.path.replace('${type}', type);
    Object.keys(messageParams).forEach(function (key) {
        opts[key] = messageParams[key];
    });
    opts.to = recipient;
    path.path += '?' + querystring.stringify(opts);
    _options.logger.info('sending message from shortcode ' + type + ' to ' + recipient + ' with parameters ' + JSON.stringify(messageParams));
    sendRequest(path, 'POST', function (err, apiResponse) {
        if (!err && apiResponse.status && apiResponse.messages[0].status > 0) {
            sendError(callback, new Error(apiResponse.messages[0]['error-text']), apiResponse);
        } else {
            if (callback) callback(err, apiResponse);
        }
    });
}
exports.shortcodeAlert = function (recipient, messageParams, opts, callback) {
    sendViaShortcode('alert', recipient, messageParams, opts, callback);
};
exports.shortcode2FA = function (recipient, messageParams, opts, callback) {
    sendViaShortcode('2fa', recipient, messageParams, opts, callback);
};
exports.shortcodeMarketing = function (recipient, messageParams, opts, callback) {
    sendViaShortcode('marketing', recipient, messageParams, opts, callback);
};

function clone(a) {
    return JSON.parse(JSON.stringify(a));
}

function getEndpoint(action) {
    return { path: action };
}

function sendRequest(endpoint, method, callback) {
    endpoint.path = endpoint.path + (endpoint.path.indexOf('?') > 0 ? '&' : '?') + querystring.stringify(up);
    _options.httpClient.request(endpoint, method, callback);
}

exports.checkBalance = function (callback) {
    var balanceEndpoint = getEndpoint('/account/get-balance');
    sendRequest(balanceEndpoint, callback);
};

exports.getPricing = function (countryCode, callback) {
    if (!countryCode || countryCode.length != 2) {
        sendError(callback, new Error(ERROR_MESSAGES.countrycode));
    } else {
        var pricingEndpoint = getEndpoint('/account/get-pricing/outbound');
        pricingEndpoint.path += '?country=' + countryCode;
        sendRequest(pricingEndpoint, callback);
    }
};

exports.getPhonePricing = function (product, msisdn, callback) {
    if (!product || product != 'sms' && product != 'voice') {
        sendError(callback, new Error(ERROR_MESSAGES.product));
    } else if (!msisdn || msisdn.length < 10) {
        // check if MSISDN validation is correct for international numbers
        sendError(callback, new Error(ERROR_MESSAGES.msisdn));
    } else {
        var pricingEndpoint = getEndpoint('/account/get-phone-pricing/outbound');
        pricingEndpoint.path += "/" + product + "/" + up.api_key + "/" + up.api_secret + "/" + msisdn;
        sendRequest(pricingEndpoint, callback);
    }
};

exports.getNumbers = function (options, callback) {
    var numbersEndpoint = getEndpoint('/account/numbers');
    if (typeof options == 'function') {
        callback = options;
    } else if ((typeof options === 'undefined' ? 'undefined' : _typeof(options)) == 'object') {
        numbersEndpoint.path = numbersEndpoint.path + '?';
        for (var key in options) {
            numbersEndpoint.path = numbersEndpoint.path + key + '=' + options[key] + '&';
        }
    } else {
        sendError(callback, new Error(ERROR_MESSAGES.optionsNotAnObject));
        return;
    }
    sendRequest(numbersEndpoint, callback);
};

exports.searchNumbers = function (countryCode, pattern, callback) {
    if (!countryCode || countryCode.length != 2) {
        sendError(callback, new Error(ERROR_MESSAGES.countrycode));
    } else {
        var searchEndpoint = getEndpoint('/number/search');
        searchEndpoint.path += '?country=' + countryCode;
        if (typeof pattern == 'function') {
            callback = pattern;
        } else if ((typeof pattern === 'undefined' ? 'undefined' : _typeof(pattern)) == 'object') {
            searchEndpoint.path = searchEndpoint.path + '&';
            for (var arg in pattern) {
                searchEndpoint.path = searchEndpoint.path + arg + '=' + pattern[arg] + '&';
            }
        } else {
            searchEndpoint.path = searchEndpoint.path + '&pattern=' + pattern;
        }
        sendRequest(searchEndpoint, callback);
    }
};

exports.buyNumber = function (countryCode, msisdn, callback) {
    if (!countryCode || countryCode.length != 2) {
        sendError(callback, new Error(ERROR_MESSAGES.countrycode));
    } else if (!msisdn || msisdn.length < 10) {
        // check if MSISDN validation is correct for international numbers
        sendError(callback, new Error(ERROR_MESSAGES.msisdn));
    } else {
        var buyEndpoint = getEndpoint('/number/buy');
        buyEndpoint.path += '?country=' + countryCode + '&msisdn=' + msisdn;
        sendRequest(buyEndpoint, 'POST', callback);
    }
};

exports.cancelNumber = function (countryCode, msisdn, callback) {
    if (!countryCode || countryCode.length != 2) {
        sendError(callback, new Error(ERROR_MESSAGES.countrycode));
    } else if (!msisdn || msisdn.length < 10) {
        sendError(callback, new Error(ERROR_MESSAGES.msisdn));
    } else {
        var cancelEndpoint = getEndpoint('/number/cancel');
        cancelEndpoint.path += '?country=' + countryCode + '&msisdn=' + msisdn;
        sendRequest(cancelEndpoint, 'POST', callback);
    }
};

exports.cancelNumber = function (countryCode, msisdn, callback) {
    if (!countryCode || countryCode.length != 2) {
        sendError(callback, new Error(ERROR_MESSAGES.countrycode));
    } else if (!msisdn || msisdn.length < 10) {
        sendError(callback, new Error(ERROR_MESSAGES.msisdn));
    } else {
        var cancelEndpoint = getEndpoint('/number/cancel');
        cancelEndpoint.path += '?country=' + countryCode + '&msisdn=' + msisdn;
        sendRequest(cancelEndpoint, 'POST', callback);
    }
};

exports.updateNumber = function (countryCode, msisdn, params, callback) {
    if (!countryCode || countryCode.length != 2) {
        sendError(callback, new Error(ERROR_MESSAGES.countrycode));
    } else if (!msisdn || msisdn.length < 10) {
        sendError(callback, new Error(ERROR_MESSAGES.msisdn));
    } else {
        var updateEndpoint = getEndpoint('/number/update');
        updateEndpoint.path += '?country=' + countryCode + '&msisdn=' + msisdn;
        updateEndpoint.path = updateEndpoint.path + '&';
        for (var arg in params) {
            updateEndpoint.path = updateEndpoint.path + arg + '=' + encodeURIComponent(params[arg]) + '&';
        }
        sendRequest(updateEndpoint, 'POST', callback);
    }
};

exports.getApplications = function (options, callback) {
    var endpoint = getEndpoint(applicationsEndpoint.path);
    endpoint.host = applicationsEndpoint.host;
    if (typeof options == 'function') {
        callback = options;
    } else if ((typeof options === 'undefined' ? 'undefined' : _typeof(options)) == 'object') {
        endpoint.path += '?';
        for (var key in options) {
            endpoint.path += key + '=' + options[key] + '&';
        }
    } else {
        sendError(callback, new Error(ERROR_MESSAGES.optionsNotAnObject));
        return;
    }
    sendRequest(endpoint, callback);
};

exports.createApplication = function (name, type, answerUrl, eventUrl, options, callback) {
    if (!name || name.length < 1) {
        sendError(callback, new Error(ERROR_MESSAGES.applicationName));
    } else if (!type || type != 'voice') {
        sendError(callback, new Error(ERROR_MESSAGES.applicationType));
    } else if (!answerUrl) {
        sendError(callback, new Error(ERROR_MESSAGES.applicationAnswerUrl));
    } else if (!eventUrl) {
        sendError(callback, new Error(ERROR_MESSAGES.applicationEventUrl));
    } else {
        var createEndpoint = getEndpoint(applicationsEndpoint.path);
        createEndpoint.host = applicationsEndpoint.host;
        createEndpoint.path += '?name=' + encodeURIComponent(name) + '&type=' + type + '&answer_url=' + answerUrl + '&event_url=' + eventUrl;
        for (var key in options) {
            createEndpoint.path += '&' + key + '=' + options[key];
        }
        sendRequest(createEndpoint, 'POST', callback);
    }
};

exports.getApplication = function (appId, callback) {
    if (!appId || appId.length < 36) {
        sendError(callback, new Error(ERROR_MESSAGES.applicationId));
    } else {
        var showEndpoint = getEndpoint(applicationsEndpoint.path + "/" + appId);
        showEndpoint.host = applicationsEndpoint.host;
        sendRequest(showEndpoint, callback);
    }
};

exports.updateApplication = function (appId, name, type, answerUrl, eventUrl, options, callback) {
    if (!appId || appId.length < 36) {
        sendError(callback, new Error(ERROR_MESSAGES.applicationId));
    } else if (!name || name.length < 1) {
        sendError(callback, new Error(ERROR_MESSAGES.applicationName));
    } else if (!type || type != 'voice') {
        sendError(callback, new Error(ERROR_MESSAGES.applicationType));
    } else if (!answerUrl) {
        sendError(callback, new Error(ERROR_MESSAGES.applicationAnswerUrl));
    } else if (!eventUrl) {
        sendError(callback, new Error(ERROR_MESSAGES.applicationEventUrl));
    } else {
        var updateEndpoint = getEndpoint(applicationsEndpoint.path + "/" + appId);
        updateEndpoint.path += '?name=' + encodeURIComponent(name) + '&type=' + type + '&answer_url=' + answerUrl + '&event_url=' + eventUrl;
        updateEndpoint.host = applicationsEndpoint.host;
        for (var key in options) {
            updateEndpoint.path = updateEndpoint.path + '&' + key + '=' + options[key];
        }
        sendRequest(updateEndpoint, 'PUT', callback);
    }
};

exports.deleteApplication = function (appId, callback) {
    if (!appId || appId.length < 36) {
        sendError(callback, new Error(ERROR_MESSAGES.applicationId));
    } else {
        var deleteEndpoint = getEndpoint(applicationsEndpoint.path + "/" + appId);
        deleteEndpoint.host = applicationsEndpoint.host;
        sendRequest(deleteEndpoint, 'DELETE', callback);
    }
};

exports.changePassword = function (newSecret, callback) {
    var settingsEndpoint = getEndpoint('/account/settings');
    settingsEndpoint.path += '?newSecret=' + encodeURIComponent(newSecret);
    sendRequest(settingsEndpoint, 'POST', callback);
};

exports.changeMoCallbackUrl = function (newUrl, callback) {
    var settingsEndpoint = getEndpoint('/account/settings');
    settingsEndpoint.path += '?moCallBackUrl=' + encodeURIComponent(newUrl);
    sendRequest(settingsEndpoint, 'POST', callback);
};

exports.changeDrCallbackUrl = function (newUrl, callback) {
    var settingsEndpoint = getEndpoint('/account/settings');
    settingsEndpoint.path += '?drCallBackUrl=' + encodeURIComponent(newUrl);
    sendRequest(settingsEndpoint, 'POST', callback);
};

exports.verifyNumber = function (inputParams, callback) {
    if (!inputParams.number || !inputParams.brand) {
        sendError(callback, new Error(ERROR_MESSAGES.verifyValidation));
    } else {
        var vEndpoint = clone(verifyEndpoint);
        vEndpoint.path += '?' + querystring.stringify(inputParams);
        sendRequest(vEndpoint, callback);
    }
};

exports.checkVerifyRequest = function (inputParams, callback) {
    if (!inputParams.request_id || !inputParams.code) {
        sendError(callback, new Error(ERROR_MESSAGES.checkVerifyValidation));
    } else {
        var vEndpoint = clone(checkVerifyEndpoint);
        vEndpoint.path += '?' + querystring.stringify(inputParams);
        sendRequest(vEndpoint, callback);
    }
};

exports.controlVerifyRequest = function (inputParams, callback) {
    if (!inputParams.request_id || !inputParams.cmd) {
        sendError(callback, new Error(ERROR_MESSAGES.controlVerifyValidation));
    } else {
        var vEndpoint = clone(controlVerifyEndpoint);
        vEndpoint.path += '?' + querystring.stringify(inputParams);
        sendRequest(vEndpoint, callback);
    }
};

exports.searchVerifyRequest = function (requestIds, callback) {
    var requestIdParam = {};
    if (!requestIds) {
        sendError(callback, new Error(ERROR_MESSAGES.searchVerifyValidation));
    } else {
        if (Array.isArray(requestIds)) {
            if (requestIds.length == 1) {
                requestIdParam.request_id = requestIds;
            } else {
                requestIdParam.request_ids = requestIds;
            }
        } else {
            requestIdParam.request_id = requestIds;
        }
        var vEndpoint = clone(searchVerifyEndpoint);
        vEndpoint.path += '?' + querystring.stringify(requestIdParam);
        sendRequest(vEndpoint, callback);
    }
};

exports.numberInsight = function (inputParams, callback) {
    numberInsightAsync(inputParams, callback);
};

exports.numberInsightBasic = function (inputParams, callback) {
    numberInsightCommon(niBasicEndpoint, inputParams, callback);
};

exports.numberInsightStandard = function (inputParams, callback) {
    numberInsightCommon(niStandardEndpoint, inputParams, callback);
};

exports.numberInsightAdvanced = function (inputParams, callback) {
    numberInsightCommon(niAdvancedEndpoint, inputParams, callback);
};

exports.numberInsightAdvancedAsync = function (inputParams, callback) {
    numberInsightAsync(inputParams, callback);
};

function numberInsightAsync(inputParams, callback) {
    if (!inputParams.number || !inputParams.callback) {
        sendError(callback, new Error(ERROR_MESSAGES.numberInsightAdvancedValidation));
    } else {
        var nEndpoint = clone(niEndpoint);
        nEndpoint.path += '?' + querystring.stringify(inputParams);
        sendRequest(nEndpoint, callback);
    }
}

function numberInsightCommon(endpoint, inputParams, callback) {
    if (validateNumber(inputParams, callback)) {
        var inputObj;
        if ((typeof inputParams === 'undefined' ? 'undefined' : _typeof(inputParams)) != 'object') {
            inputObj = { number: inputParams };
        } else {
            inputObj = inputParams;
        }
        var nEndpoint = clone(endpoint);
        nEndpoint.path += '?' + querystring.stringify(inputObj);
        sendRequest(nEndpoint, callback);
    }
}
function validateNumber(inputParams, callback) {
    if ((typeof inputParams === 'undefined' ? 'undefined' : _typeof(inputParams)) == 'object' && !inputParams.number) {
        sendError(callback, new Error(ERROR_MESSAGES.numberInsightValidation));
        return false;
    } else if ((typeof inputParams === 'undefined' ? 'undefined' : _typeof(inputParams)) == 'object' && !numberPattern.test(inputParams.number)) {
        sendError(callback, new Error(ERROR_MESSAGES.numberInsightPatternFailure));
        return false;
    } else if ((typeof inputParams === 'undefined' ? 'undefined' : _typeof(inputParams)) != 'object' && (!inputParams || !numberPattern.test(inputParams))) {
        sendError(callback, new Error(ERROR_MESSAGES.numberInsightPatternFailure));
        return false;
    }
    return true;
}

function sendVoiceMessage(voiceEndpoint, data, callback) {
    if (!data.to) {
        sendError(callback, new Error(ERROR_MESSAGES.to));
    } else {
        var endpoint = clone(voiceEndpoint);
        endpoint.path += '?' + querystring.stringify(data);
        _options.logger.info('sending TTS message to ' + data.to + ' with message ' + data.text);
        sendRequest(endpoint, 'POST', function (err, apiResponse) {
            if (!err && apiResponse.status && apiResponse.status > 0) {
                sendError(callback, new Error(apiResponse['error-text']), apiResponse);
            } else {
                if (callback) callback(err, apiResponse);
            }
        });
    }
}

exports.sendTTSMessage = function (recipient, message, opts, callback) {
    if (!message) {
        sendError(callback, new Error(ERROR_MESSAGES.msg));
    } else {
        if (!opts) {
            opts = {};
        }
        opts['to'] = recipient;
        opts['text'] = message;
        sendVoiceMessage(ttsEndpoint, opts, callback);
    }
};

exports.sendTTSPromptWithCapture = function (recipient, message, maxDigits, byeText, opts, callback) {
    if (!message) {
        sendError(callback, new Error(ERROR_MESSAGES.msg));
    } else if (!maxDigits || isNaN(maxDigits) || maxDigits.length > 16) {
        sendError(callback, new Error(ERROR_MESSAGES.maxDigits));
    } else if (!byeText) {
        sendError(callback, new Error(ERROR_MESSAGES.byeText));
    } else {
        if (!opts) {
            opts = {};
        }
        opts['to'] = recipient;
        opts['text'] = message;
        opts['max_digits'] = maxDigits;
        opts['bye_text'] = byeText;
        sendVoiceMessage(ttsPromptEndpoint, opts, callback);
    }
};

exports.sendTTSPromptWithConfirm = function (recipient, message, maxDigits, pinCode, byeText, failedText, opts, callback) {
    if (!message) {
        sendError(callback, new Error(ERROR_MESSAGES.msg));
    } else if (!maxDigits || isNaN(maxDigits) || maxDigits.length > 16) {
        sendError(callback, new Error(ERROR_MESSAGES.maxDigits));
    } else if (!pinCode || pinCode.length !== maxDigits) {
        sendError(callback, new Error(ERROR_MESSAGES.pinCode));
    } else if (!byeText) {
        sendError(callback, new Error(ERROR_MESSAGES.byeText));
    } else if (!failedText) {
        sendError(callback, new Error(ERROR_MESSAGES.failedText));
    } else {
        if (!opts) {
            opts = {};
        }
        opts['to'] = recipient;
        opts['text'] = message;
        opts['max_digits'] = maxDigits;
        opts['pin_code'] = pinCode;
        opts['bye_text'] = byeText;
        opts['failed_text'] = failedText;
        sendVoiceMessage(ttsPromptEndpoint, opts, callback);
    }
};

exports.call = function (recipient, answerUrl, opts, callback) {
    if (!answerUrl) {
        sendError(callback, new Error(ERROR_MESSAGES.answerUrl));
    } else {
        if (!opts) {
            opts = {};
        }
        opts['to'] = recipient;
        opts['answer_url'] = answerUrl;
        sendVoiceMessage(callEndpoint, opts, callback);
    }
};

function sendError(callback, err, returnData) {
    // Throw the error in case if there is no callback passed
    if (callback) {
        callback(err, returnData);
    } else {
        throw err;
    }
}

exports.setHost = function (aHost) {
    msgpath.host = aHost;
    shortcodePath.host = aHost;
    ttsEndpoint.host = aHost;
    ttsPromptEndpoint.host = aHost;
    callEndpoint.host = aHost;
    verifyEndpoint.host = aHost;
    checkVerifyEndpoint.host = aHost;
    controlVerifyEndpoint.host = aHost;
    searchVerifyEndpoint.host = aHost;
    niEndpoint.host = aHost;
    niBasicEndpoint.host = aHost;
    niStandardEndpoint.host = aHost;
    applicationsEndpoint.host = aHost;
};

exports.setPort = function (aPort) {
    port = aPort;
};
//# sourceMappingURL=data:application/json;base64,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QSx3QkFBb0IsSUFBcEIsR0FBMkIsS0FBM0I7QUFDQSwwQkFBc0IsSUFBdEIsR0FBNkIsS0FBN0I7QUFDQSx5QkFBcUIsSUFBckIsR0FBNEIsS0FBNUI7QUFDQSxlQUFXLElBQVgsR0FBa0IsS0FBbEI7QUFDRixvQkFBZ0IsSUFBaEIsR0FBdUIsS0FBdkI7QUFDQSx1QkFBbUIsSUFBbkIsR0FBMEIsS0FBMUI7QUFDQSx5QkFBcUIsSUFBckIsR0FBNEIsS0FBNUI7QUFDRCxDQWREOztBQWdCQSxRQUFRLE9BQVIsR0FBa0IsVUFBUyxLQUFULEVBQWdCO0FBQ2hDLFdBQU8sS0FBUDtBQUNELENBRkQiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciBxdWVyeXN0cmluZyA9IHJlcXVpcmUoJ3F1ZXJ5c3RyaW5nJyk7XG5cbnZhciBpbml0aWFsaXplZCA9IGZhbHNlO1xudmFyIG1zZ3BhdGggPSB7aG9zdDoncmVzdC5uZXhtby5jb20nLHBhdGg6Jy9zbXMvanNvbid9O1xudmFyIHNob3J0Y29kZVBhdGggPSB7aG9zdDoncmVzdC5uZXhtby5jb20nLHBhdGg6Jy9zYy91cy8ke3R5cGV9L2pzb24nfTtcbnZhciB0dHNFbmRwb2ludCA9IHtob3N0OidhcGkubmV4bW8uY29tJyxwYXRoOicvdHRzL2pzb24nfTtcbnZhciB0dHNQcm9tcHRFbmRwb2ludCA9IHtob3N0OidhcGkubmV4bW8uY29tJyxwYXRoOicvdHRzLXByb21wdC9qc29uJ307XG52YXIgY2FsbEVuZHBvaW50ID0ge2hvc3Q6J3Jlc3QubmV4bW8uY29tJyxwYXRoOicvY2FsbC9qc29uJ307XG52YXIgdmVyaWZ5RW5kcG9pbnQgPSB7aG9zdDonYXBpLm5leG1vLmNvbScscGF0aDonL3ZlcmlmeS9qc29uJ307XG52YXIgY2hlY2tWZXJpZnlFbmRwb2ludCA9IHtob3N0OidhcGkubmV4bW8uY29tJyxwYXRoOicvdmVyaWZ5L2NoZWNrL2pzb24nfTtcbnZhciBjb250cm9sVmVyaWZ5RW5kcG9pbnQgPSB7aG9zdDonYXBpLm5leG1vLmNvbScscGF0aDonL3ZlcmlmeS9jb250cm9sL2pzb24nfTtcbnZhciBzZWFyY2hWZXJpZnlFbmRwb2ludCA9IHtob3N0OidhcGkubmV4bW8uY29tJyxwYXRoOicvdmVyaWZ5L3NlYXJjaC9qc29uJ307XG52YXIgbmlFbmRwb2ludCA9IHtob3N0OidhcGkubmV4bW8uY29tJyxwYXRoOicvbmkvYWR2YW5jZWQvYXN5bmMvanNvbid9O1xudmFyIG5pQmFzaWNFbmRwb2ludCA9IHtob3N0OidhcGkubmV4bW8uY29tJyxwYXRoOicvbmkvYmFzaWMvanNvbid9O1xudmFyIG5pU3RhbmRhcmRFbmRwb2ludCA9IHtob3N0OidhcGkubmV4bW8uY29tJyxwYXRoOicvbmkvc3RhbmRhcmQvanNvbid9O1xudmFyIG5pQWR2YW5jZWRFbmRwb2ludCA9IHtob3N0OidhcGkubmV4bW8uY29tJyxwYXRoOicvbmkvYWR2YW5jZWQvanNvbid9O1xudmFyIGFwcGxpY2F0aW9uc0VuZHBvaW50ID0ge2hvc3Q6J2FwaS5uZXhtby5jb20nLHBhdGg6Jy92MS9hcHBsaWNhdGlvbnMnfTtcbnZhciB1cCA9IHt9O1xudmFyIG51bWJlclBhdHRlcm4gPSBuZXcgUmVnRXhwKFwiXlswLTkgKygpLV0qJFwiKTtcbnZhciBfb3B0aW9ucyA9IG51bGw7XG5cbi8vRXJyb3IgbWVzc2FnZSByZXNvdXJjZXMgYXJlIG1haW50YWluZWQgZ2xvYmFsbHkgaW4gb25lIHBsYWNlIGZvciBlYXN5IG1hbmFnZW1lbnRcbnZhciBFUlJPUl9NRVNTQUdFUyA9IHtcbiAgICBzZW5kZXI6ICdJbnZhbGlkIGZyb20gYWRkcmVzcycsXG4gICAgdG86ICdJbnZhbGlkIHRvIGFkZHJlc3MnLFxuICAgIG1zZzogJ0ludmFsaWQgVGV4dCBNZXNzYWdlJyxcbiAgICBtc2dQYXJhbXM6ICdJbnZhbGlkIHNob3J0Y29kZSBtZXNzYWdlIHBhcmFtZXRlcnMnLFxuICAgIGNvdW50cnljb2RlOiAnSW52YWxpZCBDb3VudHJ5IENvZGUnLFxuICAgIG1zaXNkbjogJ0ludmFsaWQgTVNJU0ROIHBhc3NlZCcsXG4gICAgYm9keTogJ0ludmFsaWQgQm9keSB2YWx1ZSBpbiBCaW5hcnkgTWVzc2FnZScsXG4gICAgdWRoOiAnSW52YWxpZCB1ZGggdmFsdWUgaW4gQmluYXJ5IE1lc3NhZ2UnLFxuICAgIHRpdGxlOiAnSW52YWxpZCB0aXRsZSBpbiBXQVAgUHVzaCBtZXNzYWdlJyxcbiAgICB1cmw6ICdJbnZhbGlkIHVybCBpbiBXQVAgUHVzaCBtZXNzYWdlJyxcbiAgICBtYXhEaWdpdHM6ICdJbnZhbGlkIG1heCBkaWdpdHMgZm9yIFRUUyBwcm9tcHQnLFxuICAgIGJ5ZVRleHQ6ICdJbnZhbGlkIGJ5ZSB0ZXh0IGZvciBUVFMgcHJvbXB0JyxcbiAgICBwaW5Db2RlOiAnSW52YWxpZCBwaW4gY29kZSBmb3IgVFRTIGNvbmZpcm0nLFxuICAgIGZhaWxlZFRleHQ6ICdJbnZhbGlkIGZhaWxlZCB0ZXh0IGZvciBUVFMgY29uZmlybScsXG4gICAgYW5zd2VyVXJsOiAnSW52YWxpZCBhbnN3ZXIgVVJMIGZvciBjYWxsJyxcbiAgdmVyaWZ5VmFsaWRhdGlvbjonTWlzc2luZyBNYW5kYXRvcnkgZmllbGRzIChudW1iZXIgYW5kL29yIGJyYW5kKScsXG4gIGNoZWNrVmVyaWZ5VmFsaWRhdGlvbjonTWlzc2luZyBNYW5kYXRvcnkgZmllbGRzIChyZXF1ZXN0X2lkIGFuZC9vciBjb2RlKScsXG4gIGNvbnRyb2xWZXJpZnlWYWxpZGF0aW9uOidNaXNzaW5nIE1hbmRhdG9yeSBmaWVsZHMgKHJlcXVlc3RfaWQgYW5kL29yIGNtZC1jb21tYW5kKScsXG4gIHNlYXJjaFZlcmlmeVZhbGlkYXRpb246J01pc3NpbmcgTWFuZGF0b3J5IGZpZWxkcyAocmVxdWVzdF9pZCBvciByZXF1ZXN0X2lkcyknLFxuICBudW1iZXJJbnNpZ2h0QWR2YW5jZWRWYWxpZGF0aW9uOidNaXNzaW5nIE1hbmRhdG9yeSBmaWVsZHMgKG51bWJlciBhbmQvb3IgY2FsbGJhY2sgdXJsKScsXG4gIG51bWJlckluc2lnaHRWYWxpZGF0aW9uOidNaXNzaW5nIE1hbmRhdG9yeSBmaWVsZCAtIG51bWJlcicsXG4gIG51bWJlckluc2lnaHRQYXR0ZXJuRmFpbHVyZTonTnVtYmVyIGNhbiBjb250YWluIGRpZ2l0cyBhbmQgbWF5IGluY2x1ZGUgYW55IG9yIGFsbCBvZiB0aGUgZm9sbG93aW5nOiB3aGl0ZSBzcGFjZSwgLSwrLCAoLCApLicsXG4gIG9wdGlvbnNOb3RBbk9iamVjdDonT3B0aW9ucyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgZGljdGlvbmFyeS4gQ2hlY2sgdGhlIGRvY3MgZm9yIHZhbGlkIHByb3BlcnRpZXMgZm9yIG9wdGlvbnMnLFxuICAgIGFwcGxpY2F0aW9uTmFtZTogJ0ludmFsaWQgYXJndW1lbnQ6IG5hbWUnLFxuICAgIGFwcGxpY2F0aW9uVHlwZTogJ0ludmFsaWQgYXJndW1lbnQ6IHR5cGUgKHZhbGlkIG9wdGlvbnM6IFt2b2ljZV0pJyxcbiAgICBhcHBsaWNhdGlvbkFuc3dlclVybDogJ0ludmFsaWQgYXJndW1lbnQ6IGFuc3dlclVybCcsXG4gICAgYXBwbGljYXRpb25FdmVudFVybDogJ0ludmFsaWQgYXJndW1lbnQ6IGV2ZW50VXJsJyxcbiAgICBhcHBsaWNhdGlvbklkOiAnSW52YWxpZCBhcmd1bWVudDogYXBwSWQnLFxuICAgIHByb2R1Y3Q6ICdJbnZhbGlkIHByb2R1Y3QuIFNob3VsZCBiZSBvbmUgb2YgW3ZvaWNlLCBzbXNdJ1xufTtcblxuZXhwb3J0cy5pbml0aWFsaXplID0gZnVuY3Rpb24ocGtleSwgcHNlY3JldCwgb3B0aW9ucykge1xuICAgIGlmICghcGtleSB8fCAhcHNlY3JldCkge1xuICAgICAgICB0aHJvdyAna2V5IGFuZCBzZWNyZXQgY2Fubm90IGJlIGVtcHR5LCBzZXQgdmFsaWQgdmFsdWVzJztcbiAgICB9XG4gICAgdXAgPSB7XG4gICAgICAgIGFwaV9rZXk6IHBrZXksXG4gICAgICAgIGFwaV9zZWNyZXQ6IHBzZWNyZXRcbiAgICB9XG4gICAgX29wdGlvbnMgPSBvcHRpb25zO1xuICAgIGluaXRpYWxpemVkID0gdHJ1ZTtcbn1cblxuZXhwb3J0cy5zZW5kQmluYXJ5TWVzc2FnZSA9IGZ1bmN0aW9uKHNlbmRlciwgcmVjaXBpZW50LCBib2R5LCB1ZGgsIGNhbGxiYWNrKSB7XG4gICAgaWYgKCFib2R5KSB7XG4gICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLmJvZHkpKTtcbiAgICB9IGVsc2UgaWYgKCF1ZGgpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMudWRoKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgc2VuZE1lc3NhZ2Uoe1xuICAgICAgICAgICAgZnJvbTogc2VuZGVyLFxuICAgICAgICAgICAgdG86IHJlY2lwaWVudCxcbiAgICAgICAgICAgIHR5cGU6ICdiaW5hcnknLFxuICAgICAgICAgICAgYm9keTogYm9keSxcbiAgICAgICAgICAgIHVkaDogdWRoXG4gICAgICAgIH0sIGNhbGxiYWNrKTtcbiAgICB9XG59XG5cbmV4cG9ydHMuc2VuZFdhcFB1c2hNZXNzYWdlID0gZnVuY3Rpb24oc2VuZGVyLCByZWNpcGllbnQsIHRpdGxlLCB1cmwsIHZhbGlkaXR5LCBjYWxsYmFjaykge1xuICAgIGlmICghdGl0bGUpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMudGl0bGUpKTtcbiAgICB9IGVsc2UgaWYgKCF1cmwpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMudXJsKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWxpZGl0eSA9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWxsYmFjayA9IHZhbGlkaXR5O1xuICAgICAgICAgICAgdmFsaWRpdHkgPSA4NjQwMDAwMDtcbiAgICAgICAgfVxuICAgICAgICBzZW5kTWVzc2FnZSh7XG4gICAgICAgICAgICBmcm9tOiBzZW5kZXIsXG4gICAgICAgICAgICB0bzogcmVjaXBpZW50LFxuICAgICAgICAgICAgdHlwZTogJ3dhcHB1c2gnLFxuICAgICAgICAgICAgdGl0bGU6IHRpdGxlLFxuICAgICAgICAgICAgdmFsaWRpdHk6IHZhbGlkaXR5LFxuICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgfSwgY2FsbGJhY2spO1xuICAgIH1cbn1cblxuZXhwb3J0cy5zZW5kVGV4dE1lc3NhZ2UgPSBmdW5jdGlvbihzZW5kZXIsIHJlY2lwaWVudCwgbWVzc2FnZSwgb3B0cywgY2FsbGJhY2spIHtcbiAgICBpZiAoIW1lc3NhZ2UpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMubXNnKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCFjYWxsYmFjaykge1xuICAgICAgICBjYWxsYmFjayA9IG9wdHM7XG4gICAgICAgICAgICBvcHRzID0ge307XG4gICAgICAgIH1cbiAgICAgICAgb3B0c1snZnJvbSddID0gc2VuZGVyO1xuICAgICAgICBvcHRzWyd0byddID0gcmVjaXBpZW50O1xuICAgICAgICBvcHRzWyd0ZXh0J10gPSBtZXNzYWdlO1xuICAgICAgICBzZW5kTWVzc2FnZShvcHRzLCBjYWxsYmFjayk7XG4gICAgfVxufVxuXG5leHBvcnRzLnNlbmRNZXNzYWdlID0gZnVuY3Rpb24ob3B0cywgY2FsbGJhY2spIHtcbiAgICAgICAgc2VuZE1lc3NhZ2Uob3B0cywgY2FsbGJhY2spO1xufVxuZnVuY3Rpb24gc2VuZE1lc3NhZ2UoZGF0YSwgY2FsbGJhY2spIHtcbiAgICBpZiAoIWRhdGEuZnJvbSkge1xuICAgICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5zZW5kZXIpKTtcbiAgICB9IGVsc2UgaWYgKCFkYXRhLnRvKSB7XG4gICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLnRvKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHBhdGggPSBjbG9uZShtc2dwYXRoKTtcbiAgICBwYXRoLnBhdGgrPSAnPycgKyBxdWVyeXN0cmluZy5zdHJpbmdpZnkoZGF0YSk7XG4gICAgICAgIF9vcHRpb25zLmxvZ2dlci5pbmZvKCdzZW5kaW5nIG1lc3NhZ2UgZnJvbSAnICsgZGF0YS5mcm9tICsgJyB0byAnICsgZGF0YS50byArICcgd2l0aCBtZXNzYWdlICcgKyBkYXRhLnRleHQpO1xuICAgICAgICBzZW5kUmVxdWVzdChwYXRoLCAnUE9TVCcsIGZ1bmN0aW9uKGVyciwgYXBpUmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGlmICghZXJyICYmIGFwaVJlc3BvbnNlLnN0YXR1cyAmJiBhcGlSZXNwb25zZS5tZXNzYWdlc1swXS5zdGF0dXMgPiAwKSB7XG4gICAgICAgICAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoYXBpUmVzcG9uc2UubWVzc2FnZXNbMF1bJ2Vycm9yLXRleHQnXSksIGFwaVJlc3BvbnNlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSBjYWxsYmFjayhlcnIsIGFwaVJlc3BvbnNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBzZW5kVmlhU2hvcnRjb2RlKHR5cGUsIHJlY2lwaWVudCwgbWVzc2FnZVBhcmFtcywgb3B0cywgY2FsbGJhY2spIHtcbiAgICBpZiAoIXJlY2lwaWVudCkge1xuICAgICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy50bykpO1xuICAgIH1cbiAgICBpZiAoIW1lc3NhZ2VQYXJhbXMgfHwgIU9iamVjdC5rZXlzKG1lc3NhZ2VQYXJhbXMpKSB7XG4gICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLm1zZ1BhcmFtcykpO1xuICAgIH1cbiAgICBvcHRzID0gb3B0cyB8fCB7fTtcbiAgICB2YXIgcGF0aCA9IGNsb25lKHNob3J0Y29kZVBhdGgpO1xuICAgIHBhdGgucGF0aCA9IHBhdGgucGF0aC5yZXBsYWNlKCcke3R5cGV9JywgdHlwZSk7XG4gICAgT2JqZWN0LmtleXMobWVzc2FnZVBhcmFtcykuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgb3B0c1trZXldID0gbWVzc2FnZVBhcmFtc1trZXldO1xuICAgIH0pO1xuICAgIG9wdHMudG8gPSByZWNpcGllbnQ7XG4gICAgcGF0aC5wYXRoKz0gJz8nICsgcXVlcnlzdHJpbmcuc3RyaW5naWZ5KG9wdHMpO1xuICAgIF9vcHRpb25zLmxvZ2dlci5pbmZvKCdzZW5kaW5nIG1lc3NhZ2UgZnJvbSBzaG9ydGNvZGUgJyArIHR5cGUgKyAnIHRvICcgKyByZWNpcGllbnQgKyAnIHdpdGggcGFyYW1ldGVycyAnICsgSlNPTi5zdHJpbmdpZnkobWVzc2FnZVBhcmFtcykpO1xuICAgIHNlbmRSZXF1ZXN0KHBhdGgsICdQT1NUJywgZnVuY3Rpb24oZXJyLCBhcGlSZXNwb25zZSkge1xuICAgICAgICBpZiAoIWVyciAmJiBhcGlSZXNwb25zZS5zdGF0dXMgJiYgYXBpUmVzcG9uc2UubWVzc2FnZXNbMF0uc3RhdHVzID4gMCkge1xuICAgICAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoYXBpUmVzcG9uc2UubWVzc2FnZXNbMF1bJ2Vycm9yLXRleHQnXSksIGFwaVJlc3BvbnNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChjYWxsYmFjaykgY2FsbGJhY2soZXJyLCBhcGlSZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbmV4cG9ydHMuc2hvcnRjb2RlQWxlcnQgPSBmdW5jdGlvbihyZWNpcGllbnQsIG1lc3NhZ2VQYXJhbXMsIG9wdHMsIGNhbGxiYWNrKSB7XG4gICAgc2VuZFZpYVNob3J0Y29kZSgnYWxlcnQnLCByZWNpcGllbnQsIG1lc3NhZ2VQYXJhbXMsIG9wdHMsIGNhbGxiYWNrKTtcbn1cbmV4cG9ydHMuc2hvcnRjb2RlMkZBID0gZnVuY3Rpb24ocmVjaXBpZW50LCBtZXNzYWdlUGFyYW1zLCBvcHRzLCBjYWxsYmFjaykge1xuICAgIHNlbmRWaWFTaG9ydGNvZGUoJzJmYScsIHJlY2lwaWVudCwgbWVzc2FnZVBhcmFtcywgb3B0cywgY2FsbGJhY2spO1xufVxuZXhwb3J0cy5zaG9ydGNvZGVNYXJrZXRpbmcgPSBmdW5jdGlvbihyZWNpcGllbnQsIG1lc3NhZ2VQYXJhbXMsIG9wdHMsIGNhbGxiYWNrKSB7XG4gICAgc2VuZFZpYVNob3J0Y29kZSgnbWFya2V0aW5nJywgcmVjaXBpZW50LCBtZXNzYWdlUGFyYW1zLCBvcHRzLCBjYWxsYmFjayk7XG59XG5cbmZ1bmN0aW9uIGNsb25lKGEpIHtcbiAgIHJldHVybiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGEpKTtcbn1cblxuZnVuY3Rpb24gZ2V0RW5kcG9pbnQoYWN0aW9uKSB7XG4gICAgcmV0dXJuIHtwYXRoOmFjdGlvbn07XG59XG5cbmZ1bmN0aW9uIHNlbmRSZXF1ZXN0KGVuZHBvaW50LCBtZXRob2QsIGNhbGxiYWNrKSB7XG4gIGVuZHBvaW50LnBhdGggPSBlbmRwb2ludC5wYXRoICtcbiAgICAgICAgICAgICAgICAgIChlbmRwb2ludC5wYXRoLmluZGV4T2YoJz8nKT4wPycmJzonPycpICtcbiAgICAgICAgICAgICAgICAgIHF1ZXJ5c3RyaW5nLnN0cmluZ2lmeSh1cCk7XG4gIF9vcHRpb25zLmh0dHBDbGllbnQucmVxdWVzdChlbmRwb2ludCwgbWV0aG9kLCBjYWxsYmFjayk7XG59XG5cbmV4cG9ydHMuY2hlY2tCYWxhbmNlID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICB2YXIgYmFsYW5jZUVuZHBvaW50ID0gZ2V0RW5kcG9pbnQoJy9hY2NvdW50L2dldC1iYWxhbmNlJyk7XG4gICAgc2VuZFJlcXVlc3QoYmFsYW5jZUVuZHBvaW50LCBjYWxsYmFjayk7XG59XG5cbmV4cG9ydHMuZ2V0UHJpY2luZyA9IGZ1bmN0aW9uKGNvdW50cnlDb2RlLCBjYWxsYmFjaykge1xuICAgIGlmICghY291bnRyeUNvZGUgfHwgY291bnRyeUNvZGUubGVuZ3RoICE9IDIpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMuY291bnRyeWNvZGUpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgcHJpY2luZ0VuZHBvaW50ID0gZ2V0RW5kcG9pbnQoJy9hY2NvdW50L2dldC1wcmljaW5nL291dGJvdW5kJyk7XG4gICAgcHJpY2luZ0VuZHBvaW50LnBhdGggKz0gJz9jb3VudHJ5PScgKyBjb3VudHJ5Q29kZTtcbiAgICAgICAgc2VuZFJlcXVlc3QocHJpY2luZ0VuZHBvaW50LCBjYWxsYmFjayk7XG4gICAgfVxufVxuXG5leHBvcnRzLmdldFBob25lUHJpY2luZyA9IGZ1bmN0aW9uKHByb2R1Y3QsIG1zaXNkbiwgY2FsbGJhY2spIHtcbiAgICBpZiAoIXByb2R1Y3QgfHwgKHByb2R1Y3QgIT0gJ3NtcycgJiYgcHJvZHVjdCAhPSAndm9pY2UnKSkge1xuICAgICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5wcm9kdWN0KSk7XG4gICAgfSBlbHNlIGlmICghbXNpc2RuIHx8IG1zaXNkbi5sZW5ndGggPCAxMCkgeyAvLyBjaGVjayBpZiBNU0lTRE4gdmFsaWRhdGlvbiBpcyBjb3JyZWN0IGZvciBpbnRlcm5hdGlvbmFsIG51bWJlcnNcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMubXNpc2RuKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHByaWNpbmdFbmRwb2ludCA9IGdldEVuZHBvaW50KCcvYWNjb3VudC9nZXQtcGhvbmUtcHJpY2luZy9vdXRib3VuZCcpO1xuICAgICAgICBwcmljaW5nRW5kcG9pbnQucGF0aCArPSBcIi9cIiArIHByb2R1Y3QgKyBcIi9cIiArIHVwLmFwaV9rZXkgKyBcIi9cIiArIHVwLmFwaV9zZWNyZXQgKyBcIi9cIiArIG1zaXNkbjtcbiAgICAgICAgc2VuZFJlcXVlc3QocHJpY2luZ0VuZHBvaW50LCBjYWxsYmFjayk7XG4gICAgfVxufVxuXG5leHBvcnRzLmdldE51bWJlcnMgPSBmdW5jdGlvbihvcHRpb25zLCBjYWxsYmFjaykge1xuICAgIHZhciBudW1iZXJzRW5kcG9pbnQgPSBnZXRFbmRwb2ludCgnL2FjY291bnQvbnVtYmVycycpO1xuICAgIGlmICh0eXBlb2Ygb3B0aW9ucyA9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGNhbGxiYWNrID0gb3B0aW9ucztcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBvcHRpb25zID09ICdvYmplY3QnKXtcbiAgICAgICAgbnVtYmVyc0VuZHBvaW50LnBhdGggPSBudW1iZXJzRW5kcG9pbnQucGF0aCArICc/JztcbiAgICAgICAgZm9yICh2YXIga2V5IGluIG9wdGlvbnMpe1xuICAgICAgICAgICAgbnVtYmVyc0VuZHBvaW50LnBhdGggPSBudW1iZXJzRW5kcG9pbnQucGF0aCArIGtleSArICc9JyArIG9wdGlvbnNba2V5XSArICcmJ1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMub3B0aW9uc05vdEFuT2JqZWN0KSk7XG4gICAgcmV0dXJuO1xuICAgIH1cbiAgc2VuZFJlcXVlc3QobnVtYmVyc0VuZHBvaW50LCBjYWxsYmFjayk7XG59XG5cbmV4cG9ydHMuc2VhcmNoTnVtYmVycyA9IGZ1bmN0aW9uKGNvdW50cnlDb2RlLCBwYXR0ZXJuLCBjYWxsYmFjaykge1xuICAgIGlmICghY291bnRyeUNvZGUgfHwgY291bnRyeUNvZGUubGVuZ3RoICE9IDIpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMuY291bnRyeWNvZGUpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgc2VhcmNoRW5kcG9pbnQgPSBnZXRFbmRwb2ludCgnL251bWJlci9zZWFyY2gnKSA7XG4gICAgc2VhcmNoRW5kcG9pbnQucGF0aCArPSAnP2NvdW50cnk9JyArIGNvdW50cnlDb2RlXG4gICAgICAgIGlmICh0eXBlb2YgcGF0dGVybiA9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWxsYmFjayA9IHBhdHRlcm47XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHBhdHRlcm4gPT0gJ29iamVjdCcpe1xuICAgICAgICAgICAgc2VhcmNoRW5kcG9pbnQucGF0aCA9IHNlYXJjaEVuZHBvaW50LnBhdGggKyAnJic7XG4gICAgICAgICAgICBmb3IgKHZhciBhcmcgaW4gcGF0dGVybil7XG4gICAgICAgICAgICAgICAgc2VhcmNoRW5kcG9pbnQucGF0aCA9IHNlYXJjaEVuZHBvaW50LnBhdGggKyBhcmcgKyAnPScgKyBwYXR0ZXJuW2FyZ10gKyAnJidcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNlYXJjaEVuZHBvaW50LnBhdGggPSBzZWFyY2hFbmRwb2ludC5wYXRoICsgJyZwYXR0ZXJuPScgKyBwYXR0ZXJuO1xuICAgICAgICB9XG4gICAgICAgIHNlbmRSZXF1ZXN0KHNlYXJjaEVuZHBvaW50LCBjYWxsYmFjayk7XG4gICAgfVxufVxuXG5leHBvcnRzLmJ1eU51bWJlciA9IGZ1bmN0aW9uKGNvdW50cnlDb2RlLCBtc2lzZG4sIGNhbGxiYWNrKSB7XG4gICAgaWYgKCFjb3VudHJ5Q29kZSB8fCBjb3VudHJ5Q29kZS5sZW5ndGggIT0gMikge1xuICAgICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5jb3VudHJ5Y29kZSkpO1xuICAgIH0gZWxzZSBpZiAoIW1zaXNkbiB8fCBtc2lzZG4ubGVuZ3RoIDwgMTApIHsgLy8gY2hlY2sgaWYgTVNJU0ROIHZhbGlkYXRpb24gaXMgY29ycmVjdCBmb3IgaW50ZXJuYXRpb25hbCBudW1iZXJzXG4gICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLm1zaXNkbikpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBidXlFbmRwb2ludCA9IGdldEVuZHBvaW50KCcvbnVtYmVyL2J1eScpO1xuICAgIGJ1eUVuZHBvaW50LnBhdGggKz0gJz9jb3VudHJ5PScgKyBjb3VudHJ5Q29kZSArICcmbXNpc2RuPScgKyBtc2lzZG47XG4gICAgICAgIHNlbmRSZXF1ZXN0KGJ1eUVuZHBvaW50LCAnUE9TVCcsIGNhbGxiYWNrKTtcbiAgICB9XG59XG5cbmV4cG9ydHMuY2FuY2VsTnVtYmVyID0gZnVuY3Rpb24oY291bnRyeUNvZGUsIG1zaXNkbiwgY2FsbGJhY2spIHtcbiAgICBpZiAoIWNvdW50cnlDb2RlIHx8IGNvdW50cnlDb2RlLmxlbmd0aCAhPSAyKSB7XG4gICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLmNvdW50cnljb2RlKSk7XG4gICAgfSBlbHNlIGlmICghbXNpc2RuIHx8IG1zaXNkbi5sZW5ndGggPCAxMCkge1xuICAgICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5tc2lzZG4pKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgY2FuY2VsRW5kcG9pbnQgPSBnZXRFbmRwb2ludCgnL251bWJlci9jYW5jZWwnKTtcbiAgICBjYW5jZWxFbmRwb2ludC5wYXRoICs9ICc/Y291bnRyeT0nICsgY291bnRyeUNvZGUgKyAnJm1zaXNkbj0nICsgbXNpc2RuO1xuICAgICAgICBzZW5kUmVxdWVzdChjYW5jZWxFbmRwb2ludCwgJ1BPU1QnLCBjYWxsYmFjayk7XG4gICAgfVxufVxuXG5leHBvcnRzLmNhbmNlbE51bWJlciA9IGZ1bmN0aW9uKGNvdW50cnlDb2RlLCBtc2lzZG4sIGNhbGxiYWNrKSB7XG4gICAgaWYgKCFjb3VudHJ5Q29kZSB8fCBjb3VudHJ5Q29kZS5sZW5ndGggIT0gMikge1xuICAgICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5jb3VudHJ5Y29kZSkpO1xuICAgIH0gZWxzZSBpZiAoIW1zaXNkbiB8fCBtc2lzZG4ubGVuZ3RoIDwgMTApIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMubXNpc2RuKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGNhbmNlbEVuZHBvaW50ID0gZ2V0RW5kcG9pbnQoJy9udW1iZXIvY2FuY2VsJyk7XG4gICAgY2FuY2VsRW5kcG9pbnQucGF0aCArPSAnP2NvdW50cnk9JyArIGNvdW50cnlDb2RlICsgJyZtc2lzZG49JyArIG1zaXNkbjtcbiAgICAgICAgc2VuZFJlcXVlc3QoY2FuY2VsRW5kcG9pbnQsICdQT1NUJywgY2FsbGJhY2spO1xuICAgIH1cbn1cblxuZXhwb3J0cy51cGRhdGVOdW1iZXIgPSBmdW5jdGlvbihjb3VudHJ5Q29kZSwgbXNpc2RuLCBwYXJhbXMsIGNhbGxiYWNrKXtcbiAgICBpZiAoIWNvdW50cnlDb2RlIHx8IGNvdW50cnlDb2RlLmxlbmd0aCAhPSAyKSB7XG4gICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLmNvdW50cnljb2RlKSk7XG4gICAgfSBlbHNlIGlmICghbXNpc2RuIHx8IG1zaXNkbi5sZW5ndGggPCAxMCkge1xuICAgICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5tc2lzZG4pKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgdXBkYXRlRW5kcG9pbnQgPSBnZXRFbmRwb2ludCgnL251bWJlci91cGRhdGUnKTtcbiAgdXBkYXRlRW5kcG9pbnQucGF0aCArPSAnP2NvdW50cnk9JyArIGNvdW50cnlDb2RlICsgJyZtc2lzZG49JyArIG1zaXNkbjtcbiAgICAgICAgdXBkYXRlRW5kcG9pbnQucGF0aCA9IHVwZGF0ZUVuZHBvaW50LnBhdGggKyAnJic7XG4gICAgICAgIGZvciAodmFyIGFyZyBpbiBwYXJhbXMpe1xuICAgICAgICAgICAgdXBkYXRlRW5kcG9pbnQucGF0aCA9IHVwZGF0ZUVuZHBvaW50LnBhdGggKyBhcmcgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQocGFyYW1zW2FyZ10pICsgJyYnXG4gICAgICAgIH1cbiAgICAgICAgc2VuZFJlcXVlc3QodXBkYXRlRW5kcG9pbnQsICdQT1NUJywgY2FsbGJhY2spO1xuICAgIH1cbn1cblxuZXhwb3J0cy5nZXRBcHBsaWNhdGlvbnMgPSBmdW5jdGlvbihvcHRpb25zLCBjYWxsYmFjaykge1xuICAgIHZhciBlbmRwb2ludCA9IGdldEVuZHBvaW50KGFwcGxpY2F0aW9uc0VuZHBvaW50LnBhdGgpO1xuICAgIGVuZHBvaW50Lmhvc3QgPSBhcHBsaWNhdGlvbnNFbmRwb2ludC5ob3N0O1xuICAgIGlmICh0eXBlb2Ygb3B0aW9ucyA9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGNhbGxiYWNrID0gb3B0aW9ucztcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBvcHRpb25zID09ICdvYmplY3QnKXtcbiAgICAgICAgZW5kcG9pbnQucGF0aCArPSAnPyc7XG4gICAgICAgIGZvciAodmFyIGtleSBpbiBvcHRpb25zKXtcbiAgICAgICAgICAgIGVuZHBvaW50LnBhdGggKz0gKGtleSArICc9JyArIG9wdGlvbnNba2V5XSArICcmJyk7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5vcHRpb25zTm90QW5PYmplY3QpKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgc2VuZFJlcXVlc3QoZW5kcG9pbnQsIGNhbGxiYWNrKTtcbn1cblxuZXhwb3J0cy5jcmVhdGVBcHBsaWNhdGlvbiA9IGZ1bmN0aW9uKG5hbWUsIHR5cGUsIGFuc3dlclVybCwgZXZlbnRVcmwsIG9wdGlvbnMsIGNhbGxiYWNrKSB7XG4gIGlmICghbmFtZSB8fCBuYW1lLmxlbmd0aCA8IDEpIHtcbiAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLmFwcGxpY2F0aW9uTmFtZSkpO1xuICB9IGVsc2UgaWYgKCF0eXBlIHx8IHR5cGUgIT0gJ3ZvaWNlJykge1xuICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMuYXBwbGljYXRpb25UeXBlKSk7XG4gIH0gZWxzZSBpZiAoIWFuc3dlclVybCkge1xuICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMuYXBwbGljYXRpb25BbnN3ZXJVcmwpKTtcbiAgfSBlbHNlIGlmICghZXZlbnRVcmwpIHtcbiAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLmFwcGxpY2F0aW9uRXZlbnRVcmwpKTtcbiAgfSBlbHNlIHtcbiAgICAgIHZhciBjcmVhdGVFbmRwb2ludCA9IGdldEVuZHBvaW50KGFwcGxpY2F0aW9uc0VuZHBvaW50LnBhdGgpO1xuICAgICAgY3JlYXRlRW5kcG9pbnQuaG9zdCA9IGFwcGxpY2F0aW9uc0VuZHBvaW50Lmhvc3Q7XG4gICAgICBjcmVhdGVFbmRwb2ludC5wYXRoICs9ICgnP25hbWU9JyArIGVuY29kZVVSSUNvbXBvbmVudChuYW1lKSArICcmdHlwZT0nICsgdHlwZSAgKyAnJmFuc3dlcl91cmw9JyArIGFuc3dlclVybCAgKyAnJmV2ZW50X3VybD0nICsgZXZlbnRVcmwpO1xuICAgICAgZm9yICh2YXIga2V5IGluIG9wdGlvbnMpe1xuICAgICAgICAgIGNyZWF0ZUVuZHBvaW50LnBhdGggKz0gKCcmJyArIGtleSArICc9JyArIG9wdGlvbnNba2V5XSk7XG4gICAgICB9XG4gICAgICBzZW5kUmVxdWVzdChjcmVhdGVFbmRwb2ludCwgJ1BPU1QnLCBjYWxsYmFjayk7XG4gIH1cbn1cblxuZXhwb3J0cy5nZXRBcHBsaWNhdGlvbiA9IGZ1bmN0aW9uKGFwcElkLCBjYWxsYmFjaykge1xuICBpZiAoIWFwcElkIHx8IGFwcElkLmxlbmd0aCA8IDM2KSB7XG4gICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5hcHBsaWNhdGlvbklkKSk7XG4gIH0gZWxzZSB7XG4gICAgICB2YXIgc2hvd0VuZHBvaW50ID0gZ2V0RW5kcG9pbnQoYXBwbGljYXRpb25zRW5kcG9pbnQucGF0aCArIFwiL1wiICsgYXBwSWQpO1xuICAgICAgc2hvd0VuZHBvaW50Lmhvc3QgPSBhcHBsaWNhdGlvbnNFbmRwb2ludC5ob3N0O1xuICAgICAgc2VuZFJlcXVlc3Qoc2hvd0VuZHBvaW50LCBjYWxsYmFjayk7XG4gIH1cbn1cblxuZXhwb3J0cy51cGRhdGVBcHBsaWNhdGlvbiA9IGZ1bmN0aW9uKGFwcElkLCBuYW1lLCB0eXBlLCBhbnN3ZXJVcmwsIGV2ZW50VXJsLCBvcHRpb25zLCBjYWxsYmFjaykge1xuICBpZiAoIWFwcElkIHx8IGFwcElkLmxlbmd0aCA8IDM2KSB7XG4gICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5hcHBsaWNhdGlvbklkKSk7XG4gIH0gZWxzZSBpZiAoIW5hbWUgfHwgbmFtZS5sZW5ndGggPCAxKSB7XG4gICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5hcHBsaWNhdGlvbk5hbWUpKTtcbiAgfSBlbHNlIGlmICghdHlwZSB8fCB0eXBlICE9ICd2b2ljZScpIHtcbiAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLmFwcGxpY2F0aW9uVHlwZSkpO1xuICB9IGVsc2UgaWYgKCFhbnN3ZXJVcmwpIHtcbiAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLmFwcGxpY2F0aW9uQW5zd2VyVXJsKSk7XG4gIH0gZWxzZSBpZiAoIWV2ZW50VXJsKSB7XG4gICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5hcHBsaWNhdGlvbkV2ZW50VXJsKSk7XG4gIH0gZWxzZSB7XG4gICAgICB2YXIgdXBkYXRlRW5kcG9pbnQgPSBnZXRFbmRwb2ludChhcHBsaWNhdGlvbnNFbmRwb2ludC5wYXRoICsgXCIvXCIgKyBhcHBJZCk7XG4gICAgICB1cGRhdGVFbmRwb2ludC5wYXRoICs9ICgnP25hbWU9JyArIGVuY29kZVVSSUNvbXBvbmVudChuYW1lKSArICcmdHlwZT0nICsgdHlwZSAgKyAnJmFuc3dlcl91cmw9JyArIGFuc3dlclVybCAgKyAnJmV2ZW50X3VybD0nICsgZXZlbnRVcmwpO1xuICAgICAgdXBkYXRlRW5kcG9pbnQuaG9zdCA9IGFwcGxpY2F0aW9uc0VuZHBvaW50Lmhvc3Q7XG4gICAgICBmb3IgKHZhciBrZXkgaW4gb3B0aW9ucyl7XG4gICAgICAgICAgdXBkYXRlRW5kcG9pbnQucGF0aCA9IHVwZGF0ZUVuZHBvaW50LnBhdGggKyAnJicgKyBrZXkgKyAnPScgKyBvcHRpb25zW2tleV07XG4gICAgICB9XG4gICAgICBzZW5kUmVxdWVzdCh1cGRhdGVFbmRwb2ludCwgJ1BVVCcsIGNhbGxiYWNrKTtcbiAgfVxufVxuXG5leHBvcnRzLmRlbGV0ZUFwcGxpY2F0aW9uID0gZnVuY3Rpb24oYXBwSWQsIGNhbGxiYWNrKSB7XG4gIGlmICghYXBwSWQgfHwgYXBwSWQubGVuZ3RoIDwgMzYpIHtcbiAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLmFwcGxpY2F0aW9uSWQpKTtcbiAgfSBlbHNlIHtcbiAgICAgIHZhciBkZWxldGVFbmRwb2ludCA9IGdldEVuZHBvaW50KGFwcGxpY2F0aW9uc0VuZHBvaW50LnBhdGggKyBcIi9cIiArIGFwcElkKTtcbiAgICAgIGRlbGV0ZUVuZHBvaW50Lmhvc3QgPSBhcHBsaWNhdGlvbnNFbmRwb2ludC5ob3N0O1xuICAgICAgc2VuZFJlcXVlc3QoZGVsZXRlRW5kcG9pbnQsICdERUxFVEUnLCBjYWxsYmFjayk7XG4gIH1cbn1cblxuXG5leHBvcnRzLmNoYW5nZVBhc3N3b3JkID0gZnVuY3Rpb24obmV3U2VjcmV0LCBjYWxsYmFjaykge1xuICAgIHZhciBzZXR0aW5nc0VuZHBvaW50ID0gZ2V0RW5kcG9pbnQoJy9hY2NvdW50L3NldHRpbmdzJyk7XG4gIHNldHRpbmdzRW5kcG9pbnQucGF0aCArPSAnP25ld1NlY3JldD0nICsgZW5jb2RlVVJJQ29tcG9uZW50KG5ld1NlY3JldCk7XG4gICAgc2VuZFJlcXVlc3Qoc2V0dGluZ3NFbmRwb2ludCwgJ1BPU1QnLCBjYWxsYmFjayk7XG59XG5cbmV4cG9ydHMuY2hhbmdlTW9DYWxsYmFja1VybCA9IGZ1bmN0aW9uKG5ld1VybCwgY2FsbGJhY2spIHtcbiAgICB2YXIgc2V0dGluZ3NFbmRwb2ludCA9IGdldEVuZHBvaW50KCcvYWNjb3VudC9zZXR0aW5ncycpO1xuICBzZXR0aW5nc0VuZHBvaW50LnBhdGggICs9ICc/bW9DYWxsQmFja1VybD0nICsgZW5jb2RlVVJJQ29tcG9uZW50KG5ld1VybCk7XG4gICAgc2VuZFJlcXVlc3Qoc2V0dGluZ3NFbmRwb2ludCwgJ1BPU1QnLCBjYWxsYmFjayk7XG59XG5cbmV4cG9ydHMuY2hhbmdlRHJDYWxsYmFja1VybCA9IGZ1bmN0aW9uKG5ld1VybCwgY2FsbGJhY2spIHtcbiAgICB2YXIgc2V0dGluZ3NFbmRwb2ludCA9IGdldEVuZHBvaW50KCcvYWNjb3VudC9zZXR0aW5ncycpO1xuICBzZXR0aW5nc0VuZHBvaW50LnBhdGggICs9ICc/ZHJDYWxsQmFja1VybD0nICsgZW5jb2RlVVJJQ29tcG9uZW50KG5ld1VybCk7XG4gICAgc2VuZFJlcXVlc3Qoc2V0dGluZ3NFbmRwb2ludCwgJ1BPU1QnLCBjYWxsYmFjayk7XG59XG5cbmV4cG9ydHMudmVyaWZ5TnVtYmVyID0gZnVuY3Rpb24oaW5wdXRQYXJhbXMsIGNhbGxiYWNrKSB7XG4gIGlmICghaW5wdXRQYXJhbXMubnVtYmVyIHx8ICFpbnB1dFBhcmFtcy5icmFuZCApIHtcbiAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy52ZXJpZnlWYWxpZGF0aW9uKSk7XG4gICAgfSBlbHNlIHtcbiAgICB2YXIgdkVuZHBvaW50ID0gY2xvbmUodmVyaWZ5RW5kcG9pbnQpO1xuICAgIHZFbmRwb2ludC5wYXRoICs9ICc/JyArIHF1ZXJ5c3RyaW5nLnN0cmluZ2lmeShpbnB1dFBhcmFtcyk7XG4gICAgICAgIHNlbmRSZXF1ZXN0KHZFbmRwb2ludCwgY2FsbGJhY2spO1xuICAgIH1cbn1cblxuZXhwb3J0cy5jaGVja1ZlcmlmeVJlcXVlc3QgPSBmdW5jdGlvbihpbnB1dFBhcmFtcywgY2FsbGJhY2spIHtcbiAgaWYgKCFpbnB1dFBhcmFtcy5yZXF1ZXN0X2lkIHx8ICFpbnB1dFBhcmFtcy5jb2RlICkge1xuICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLmNoZWNrVmVyaWZ5VmFsaWRhdGlvbikpO1xuICAgIH0gZWxzZSB7XG4gICAgdmFyIHZFbmRwb2ludCA9IGNsb25lKGNoZWNrVmVyaWZ5RW5kcG9pbnQpO1xuICAgIHZFbmRwb2ludC5wYXRoICs9ICc/JyArIHF1ZXJ5c3RyaW5nLnN0cmluZ2lmeShpbnB1dFBhcmFtcyk7XG4gICAgICAgIHNlbmRSZXF1ZXN0KHZFbmRwb2ludCwgY2FsbGJhY2spO1xuICAgIH1cbn1cblxuZXhwb3J0cy5jb250cm9sVmVyaWZ5UmVxdWVzdCA9IGZ1bmN0aW9uKGlucHV0UGFyYW1zLCBjYWxsYmFjaykge1xuICBpZiAoIWlucHV0UGFyYW1zLnJlcXVlc3RfaWQgfHwgIWlucHV0UGFyYW1zLmNtZCApIHtcbiAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5jb250cm9sVmVyaWZ5VmFsaWRhdGlvbikpO1xuICAgIH0gZWxzZSB7XG4gICAgdmFyIHZFbmRwb2ludCA9IGNsb25lKGNvbnRyb2xWZXJpZnlFbmRwb2ludCk7XG4gICAgdkVuZHBvaW50LnBhdGggKz0gJz8nICsgcXVlcnlzdHJpbmcuc3RyaW5naWZ5KGlucHV0UGFyYW1zKTtcbiAgICAgICAgc2VuZFJlcXVlc3QodkVuZHBvaW50LCBjYWxsYmFjayk7XG4gICAgfVxufVxuXG5leHBvcnRzLnNlYXJjaFZlcmlmeVJlcXVlc3QgPSBmdW5jdGlvbihyZXF1ZXN0SWRzLCBjYWxsYmFjaykge1xuICB2YXIgcmVxdWVzdElkUGFyYW0gPSB7fTtcbiAgaWYgKCFyZXF1ZXN0SWRzKSB7XG4gICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMuc2VhcmNoVmVyaWZ5VmFsaWRhdGlvbikpO1xuICAgIH0gZWxzZSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkocmVxdWVzdElkcykgKSB7XG4gICAgICBpZiAocmVxdWVzdElkcy5sZW5ndGggPT0xKSB7XG4gICAgICAgIHJlcXVlc3RJZFBhcmFtLnJlcXVlc3RfaWQ9cmVxdWVzdElkcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlcXVlc3RJZFBhcmFtLnJlcXVlc3RfaWRzPXJlcXVlc3RJZHM7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlcXVlc3RJZFBhcmFtLnJlcXVlc3RfaWQ9cmVxdWVzdElkcztcbiAgICB9XG4gICAgdmFyIHZFbmRwb2ludCA9IGNsb25lKHNlYXJjaFZlcmlmeUVuZHBvaW50KTtcbiAgICB2RW5kcG9pbnQucGF0aCArPSAnPycgKyBxdWVyeXN0cmluZy5zdHJpbmdpZnkocmVxdWVzdElkUGFyYW0pO1xuICAgICAgICBzZW5kUmVxdWVzdCh2RW5kcG9pbnQsIGNhbGxiYWNrKTtcbiAgICB9XG59XG5cbmV4cG9ydHMubnVtYmVySW5zaWdodCA9IGZ1bmN0aW9uKGlucHV0UGFyYW1zLCBjYWxsYmFjaykge1xuICBudW1iZXJJbnNpZ2h0QXN5bmMoaW5wdXRQYXJhbXMsIGNhbGxiYWNrKTtcbn1cblxuZXhwb3J0cy5udW1iZXJJbnNpZ2h0QmFzaWMgPSBmdW5jdGlvbihpbnB1dFBhcmFtcywgY2FsbGJhY2spIHtcbiAgbnVtYmVySW5zaWdodENvbW1vbihuaUJhc2ljRW5kcG9pbnQsaW5wdXRQYXJhbXMsY2FsbGJhY2spXG59XG5cbmV4cG9ydHMubnVtYmVySW5zaWdodFN0YW5kYXJkID0gZnVuY3Rpb24oaW5wdXRQYXJhbXMsIGNhbGxiYWNrKSB7XG4gIG51bWJlckluc2lnaHRDb21tb24obmlTdGFuZGFyZEVuZHBvaW50LGlucHV0UGFyYW1zLGNhbGxiYWNrKVxufVxuXG5leHBvcnRzLm51bWJlckluc2lnaHRBZHZhbmNlZCA9IGZ1bmN0aW9uKGlucHV0UGFyYW1zLCBjYWxsYmFjaykge1xuICBudW1iZXJJbnNpZ2h0Q29tbW9uKG5pQWR2YW5jZWRFbmRwb2ludCxpbnB1dFBhcmFtcyxjYWxsYmFjaylcbn1cblxuZXhwb3J0cy5udW1iZXJJbnNpZ2h0QWR2YW5jZWRBc3luYyA9IGZ1bmN0aW9uKGlucHV0UGFyYW1zLCBjYWxsYmFjaykge1xuICBudW1iZXJJbnNpZ2h0QXN5bmMoaW5wdXRQYXJhbXMsIGNhbGxiYWNrKTtcbn1cblxuZnVuY3Rpb24gbnVtYmVySW5zaWdodEFzeW5jKGlucHV0UGFyYW1zLCBjYWxsYmFjaykge1xuICBpZiAoIWlucHV0UGFyYW1zLm51bWJlciB8fCAhIGlucHV0UGFyYW1zLmNhbGxiYWNrKSB7XG4gICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMubnVtYmVySW5zaWdodEFkdmFuY2VkVmFsaWRhdGlvbikpO1xuICB9IGVsc2Uge1xuICAgIHZhciBuRW5kcG9pbnQgPSBjbG9uZShuaUVuZHBvaW50KTtcbiAgICBuRW5kcG9pbnQucGF0aCArPSAnPycgKyBxdWVyeXN0cmluZy5zdHJpbmdpZnkoaW5wdXRQYXJhbXMpO1xuICAgIHNlbmRSZXF1ZXN0KG5FbmRwb2ludCwgY2FsbGJhY2spO1xuICB9XG59XG5cbmZ1bmN0aW9uIG51bWJlckluc2lnaHRDb21tb24oZW5kcG9pbnQsaW5wdXRQYXJhbXMsY2FsbGJhY2spIHtcbiAgaWYgKHZhbGlkYXRlTnVtYmVyKGlucHV0UGFyYW1zLGNhbGxiYWNrKSl7XG4gICAgdmFyIGlucHV0T2JqO1xuICAgIGlmICh0eXBlb2YgaW5wdXRQYXJhbXMgIT0gJ29iamVjdCcpIHtcbiAgICAgIGlucHV0T2JqID0ge251bWJlcjppbnB1dFBhcmFtc307XG4gICAgfSBlbHNlIHtcbiAgICAgIGlucHV0T2JqID0gaW5wdXRQYXJhbXM7XG4gICAgfVxuICAgIHZhciBuRW5kcG9pbnQgPSBjbG9uZShlbmRwb2ludCk7XG4gICAgbkVuZHBvaW50LnBhdGggKz0gJz8nICsgcXVlcnlzdHJpbmcuc3RyaW5naWZ5KGlucHV0T2JqKTtcbiAgICAgIHNlbmRSZXF1ZXN0KG5FbmRwb2ludCwgY2FsbGJhY2spO1xuICB9XG59XG5mdW5jdGlvbiB2YWxpZGF0ZU51bWJlcihpbnB1dFBhcmFtcyxjYWxsYmFjaykge1xuICBpZiAoKHR5cGVvZiBpbnB1dFBhcmFtcyA9PSAnb2JqZWN0JykgJiYgIWlucHV0UGFyYW1zLm51bWJlcikge1xuICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMubnVtYmVySW5zaWdodFZhbGlkYXRpb24pKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgfSBlbHNlIGlmICgodHlwZW9mIGlucHV0UGFyYW1zID09ICdvYmplY3QnKSAmJiAhbnVtYmVyUGF0dGVybi50ZXN0KGlucHV0UGFyYW1zLm51bWJlcikpIHtcbiAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLm51bWJlckluc2lnaHRQYXR0ZXJuRmFpbHVyZSkpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0gZWxzZSBpZiAoKHR5cGVvZiBpbnB1dFBhcmFtcyAhPSAnb2JqZWN0JykgJiYgKCFpbnB1dFBhcmFtcyB8fCAhbnVtYmVyUGF0dGVybi50ZXN0KGlucHV0UGFyYW1zKSkpe1xuICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLm51bWJlckluc2lnaHRQYXR0ZXJuRmFpbHVyZSkpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gc2VuZFZvaWNlTWVzc2FnZSh2b2ljZUVuZHBvaW50LCBkYXRhLCBjYWxsYmFjaykge1xuICAgIGlmICghZGF0YS50bykge1xuICAgICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy50bykpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBlbmRwb2ludCA9IGNsb25lKHZvaWNlRW5kcG9pbnQpO1xuICAgIGVuZHBvaW50LnBhdGggKz0gJz8nICsgcXVlcnlzdHJpbmcuc3RyaW5naWZ5KGRhdGEpO1xuICAgICAgICBfb3B0aW9ucy5sb2dnZXIuaW5mbygnc2VuZGluZyBUVFMgbWVzc2FnZSB0byAnICsgZGF0YS50byArICcgd2l0aCBtZXNzYWdlICcgKyBkYXRhLnRleHQpO1xuICAgICAgICBzZW5kUmVxdWVzdChlbmRwb2ludCwgJ1BPU1QnLCBmdW5jdGlvbihlcnIsIGFwaVJlc3BvbnNlKSB7XG4gICAgICAgICAgICBpZiAoIWVyciAmJiBhcGlSZXNwb25zZS5zdGF0dXMgJiYgYXBpUmVzcG9uc2Uuc3RhdHVzID4gMCkge1xuICAgICAgICAgICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKGFwaVJlc3BvbnNlWydlcnJvci10ZXh0J10pLCBhcGlSZXNwb25zZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjaykgY2FsbGJhY2soZXJyLCBhcGlSZXNwb25zZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuZXhwb3J0cy5zZW5kVFRTTWVzc2FnZSA9IGZ1bmN0aW9uKHJlY2lwaWVudCwgbWVzc2FnZSwgb3B0cywgY2FsbGJhY2spIHtcbiAgICBpZiAoIW1lc3NhZ2UpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMubXNnKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCFvcHRzKSB7XG4gICAgICAgICAgICBvcHRzID0ge307XG4gICAgICAgIH1cbiAgICAgICAgb3B0c1sndG8nXSA9IHJlY2lwaWVudDtcbiAgICAgICAgb3B0c1sndGV4dCddID0gbWVzc2FnZTtcbiAgICAgICAgc2VuZFZvaWNlTWVzc2FnZSh0dHNFbmRwb2ludCwgb3B0cywgY2FsbGJhY2spO1xuICAgIH1cbn1cblxuZXhwb3J0cy5zZW5kVFRTUHJvbXB0V2l0aENhcHR1cmUgPSBmdW5jdGlvbihyZWNpcGllbnQsIG1lc3NhZ2UsIG1heERpZ2l0cywgYnllVGV4dCwgb3B0cywgY2FsbGJhY2spIHtcbiAgICBpZiAoIW1lc3NhZ2UpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMubXNnKSk7XG4gICAgfSBlbHNlIGlmICghbWF4RGlnaXRzIHx8IGlzTmFOKG1heERpZ2l0cykgfHwgbWF4RGlnaXRzLmxlbmd0aCA+IDE2KSB7XG4gICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLm1heERpZ2l0cykpO1xuICAgIH0gZWxzZSBpZiAoIWJ5ZVRleHQpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMuYnllVGV4dCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICghb3B0cykge1xuICAgICAgICAgICAgb3B0cyA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIG9wdHNbJ3RvJ10gPSByZWNpcGllbnQ7XG4gICAgICAgIG9wdHNbJ3RleHQnXSA9IG1lc3NhZ2U7XG4gICAgICAgIG9wdHNbJ21heF9kaWdpdHMnXSA9IG1heERpZ2l0cztcbiAgICAgICAgb3B0c1snYnllX3RleHQnXSA9IGJ5ZVRleHQ7XG4gICAgICAgIHNlbmRWb2ljZU1lc3NhZ2UodHRzUHJvbXB0RW5kcG9pbnQsIG9wdHMsIGNhbGxiYWNrKTtcbiAgICB9XG59XG5cbmV4cG9ydHMuc2VuZFRUU1Byb21wdFdpdGhDb25maXJtID0gZnVuY3Rpb24ocmVjaXBpZW50LCBtZXNzYWdlLCBtYXhEaWdpdHMsIHBpbkNvZGUsIGJ5ZVRleHQsIGZhaWxlZFRleHQsIG9wdHMsIGNhbGxiYWNrKSB7XG4gICAgaWYgKCFtZXNzYWdlKSB7XG4gICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLm1zZykpO1xuICAgIH0gZWxzZSBpZiAoIW1heERpZ2l0cyB8fCBpc05hTihtYXhEaWdpdHMpIHx8IG1heERpZ2l0cy5sZW5ndGggPiAxNikge1xuICAgICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5tYXhEaWdpdHMpKTtcbiAgICB9IGVsc2UgaWYgKCFwaW5Db2RlIHx8IHBpbkNvZGUubGVuZ3RoICE9PSBtYXhEaWdpdHMpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMucGluQ29kZSkpO1xuICAgIH0gZWxzZSBpZiAoIWJ5ZVRleHQpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMuYnllVGV4dCkpO1xuICAgIH0gZWxzZSBpZiAoIWZhaWxlZFRleHQpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMuZmFpbGVkVGV4dCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICghb3B0cykge1xuICAgICAgICAgICAgb3B0cyA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIG9wdHNbJ3RvJ10gPSByZWNpcGllbnQ7XG4gICAgICAgIG9wdHNbJ3RleHQnXSA9IG1lc3NhZ2U7XG4gICAgICAgIG9wdHNbJ21heF9kaWdpdHMnXSA9IG1heERpZ2l0cztcbiAgICAgICAgb3B0c1sncGluX2NvZGUnXSA9IHBpbkNvZGU7XG4gICAgICAgIG9wdHNbJ2J5ZV90ZXh0J10gPSBieWVUZXh0O1xuICAgICAgICBvcHRzWydmYWlsZWRfdGV4dCddID0gZmFpbGVkVGV4dDtcbiAgICAgICAgc2VuZFZvaWNlTWVzc2FnZSh0dHNQcm9tcHRFbmRwb2ludCwgb3B0cywgY2FsbGJhY2spO1xuICAgIH1cbn1cblxuZXhwb3J0cy5jYWxsID0gZnVuY3Rpb24ocmVjaXBpZW50LCBhbnN3ZXJVcmwsIG9wdHMsIGNhbGxiYWNrKSB7XG4gICAgaWYgKCFhbnN3ZXJVcmwpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMuYW5zd2VyVXJsKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCFvcHRzKSB7XG4gICAgICAgICAgICBvcHRzID0ge307XG4gICAgICAgIH1cbiAgICAgICAgb3B0c1sndG8nXSA9IHJlY2lwaWVudDtcbiAgICAgICAgb3B0c1snYW5zd2VyX3VybCddID0gYW5zd2VyVXJsO1xuICAgICAgICBzZW5kVm9pY2VNZXNzYWdlKGNhbGxFbmRwb2ludCwgb3B0cywgY2FsbGJhY2spO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gc2VuZEVycm9yKGNhbGxiYWNrLCBlcnIsIHJldHVybkRhdGEpIHtcbiAgICAvLyBUaHJvdyB0aGUgZXJyb3IgaW4gY2FzZSBpZiB0aGVyZSBpcyBubyBjYWxsYmFjayBwYXNzZWRcbiAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgY2FsbGJhY2soZXJyLCByZXR1cm5EYXRhKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBlcnI7XG4gICAgfVxufVxuXG5leHBvcnRzLnNldEhvc3QgPSBmdW5jdGlvbihhSG9zdCkge1xuICAgIG1zZ3BhdGguaG9zdCA9IGFIb3N0O1xuICAgIHNob3J0Y29kZVBhdGguaG9zdCA9IGFIb3N0O1xuICAgIHR0c0VuZHBvaW50Lmhvc3QgPSBhSG9zdDtcbiAgICB0dHNQcm9tcHRFbmRwb2ludC5ob3N0ID0gYUhvc3Q7XG4gICAgY2FsbEVuZHBvaW50Lmhvc3QgPSBhSG9zdDtcbiAgICB2ZXJpZnlFbmRwb2ludC5ob3N0ID0gYUhvc3Q7XG4gICAgY2hlY2tWZXJpZnlFbmRwb2ludC5ob3N0ID0gYUhvc3Q7XG4gICAgY29udHJvbFZlcmlmeUVuZHBvaW50Lmhvc3QgPSBhSG9zdDtcbiAgICBzZWFyY2hWZXJpZnlFbmRwb2ludC5ob3N0ID0gYUhvc3Q7XG4gICAgbmlFbmRwb2ludC5ob3N0ID0gYUhvc3Q7XG4gIG5pQmFzaWNFbmRwb2ludC5ob3N0ID0gYUhvc3Q7XG4gIG5pU3RhbmRhcmRFbmRwb2ludC5ob3N0ID0gYUhvc3Q7XG4gIGFwcGxpY2F0aW9uc0VuZHBvaW50Lmhvc3QgPSBhSG9zdDtcbn1cblxuZXhwb3J0cy5zZXRQb3J0ID0gZnVuY3Rpb24oYVBvcnQpIHtcbiAgcG9ydCA9IGFQb3J0O1xufVxuIl19